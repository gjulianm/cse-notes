\documentclass[palatino]{epflnotes}

\title{Instability}
\author{Guillermo Julián Moreno}
\date{16/17 - Fall semester}

% Additional packages
\usepackage{tikztools}
\usepackage{caption}
% --------------------

\begin{document}
\frontmatter
\pagestyle{plain}
\maketitle

\tableofcontents
\mainmatter
% Content

\chapter{Introduction and basic definitions}

\section{Stability}

\begin{defn}[Monotonous stability][Stability!monotonous] A system where, given an initial disturbance of the energy $E$, it tends to the stable state with monotonically decreasing energy function.
\end{defn}

\begin{defn}[Asymptotic stability][Stability!asymptotic] A system where, given an initial energy disturbance, it tends to the stable state with no restrictions on the shape of the function.
\end{defn}

\begin{defn}[Conditional stability][Stability!conditional] A system where the stable state depends of the quantity of the initial disturbance.
\end{defn}

\begin{defn}[Inconditional instability][Instability!inconditional] I don't think this deserves a definition. In some instances we will be interested in small increments of time in order to be able to linearize the equation.
\end{defn}

\section{Case study: dynamical system of a rotating ring}

\begin{figure}[hbtp]
\centering
\inputtikz{RotatingRing}
\caption{A ball in a rotating ring has two different forces: centrifugal and gravity. When the projection of these two are equal, the ball will not move and will thus reach an equilibrum (stable state).}
\label{fig:Introduction:RotatingRing}
\end{figure}

We will study an example of conditional stability: a ball of mass $m$ in a ring of radius $R$ as in \fref{fig:Introduction:RotatingRing}. We want to find the stable state, in which the projections of the centrifugal and gravity forces over the tangent line to the ring cancel themselves.

The gravity force is easy enough: $-mg$ being $g$ the acceleration of gravity. Centrifugal force is easy too: we only have to take into account that the radius at which the ball is rotating (dotted orange path on the figure) depends on the angle θ, simply by $r = R \sin θ$. Thus, the centrifugal force is $mRω^2\cos ω $.

Adding these two forces projected accordingly over the tangent line to the circle (purple line i \fref{fig:Introduction:RotatingRing}) we have the resultant force $F$ exerted over the ball: \( F = -mg\sin θ + mRω^2 \sin θ \cos θ\)

We can substitute the force by the expression $mR\ddot{θ}$ where $\ddot{θ}$ is the angular acceleration of the ball. This gives us the final differential equation for the ball in a rotating ring movement: \( mR\ddot{θ} = -m g \sin θ + m R ω^2 \sin θ \cos θ \label{eq:Introduction:RotatingRingEquationComplete} \)

We can simplify this equation by defining $ω_0^2 = \frac{g}{R}$ as the pendulum frequency, which we will see later why it is interesting. A straightforward substitution yields a simpler equation: \( \ddot{θ} = -ω_0^2 \sin θ + ω^2 \sin θ \cos θ \label{eq:Introduction:RotatingRingEquation} \)

This is not a differential equation that can be solved in a straightforward way. However, we can study what happens when we add a small perturbation.

Our base, stable case is $θ = 0$, which is obviously a solution of \eqref{eq:Introduction:RotatingRingEquation}. What happens when we start with $θ(0) = ε$, with $ε > 0$ as small as required?

Given that ε is small, we can approximate $\sin ε \approx ε$ and $\cos ε \approx 1$ so that our equation becomes \( \ddot{θ} = -ω_0^2 θ + ω^2 θ = (ω^2 - ω_0^2) θ \label{eq:Introduction:RotatingRingSimple} \)

The solution to this simplified differential equation is \( θ = c_1 e^{\sqrt{ω^2 - ω_0^2} t} + c_2 e^{-\sqrt{ω^2 - ω_0^2} t} \label{eq:Introduction:PendulumSolution} \) with $c_1, c_2$ constants depending on the initial conditions. Let's calculate them, as we will need them later to describe the equations. For simplicity, we can suppose that the initial velocity is null ($\dot{θ}(0) = 0$) and thus what we end up with is that $c_1 = c_2 = \sfrac{ε}{2}$

Now on to the actual interesting part: study the behaviour of the solution depending on the value of $ω^2 - ω_0^2$. If $ω^2 < ω_0^2$, the square root is imaginary and our solution will be a cosine: $θ(t) = ε \cos \left[(ω_0^2 - ω^2) t\right]$\footnote{Notice the sign change on $ω_0^2 - ω^2$, important because we want to get the imaginary value out of the square root.}. Thus, in this case the ball will only oscillate between the angles $θ = \pm ε$.

However, if $ω^2 > ω_0^2$, things change. In this case the square root is real, and thus the solution grows exponentially to infinity (first exponential grows, second one quickly decreases to 0 as it has a negative sign). This would be the \textbf{unstable} situation.

An interesting phenomenon is that when we are in the stable zone ($ω^2 < ω_0^2$) but with both quantities very similar, the relaxation time (that is, the time it takes to the system to go back to the stable state) starts to grow up to infinity.

\subsection{Equilibrum states}

\begin{figure}[hbtp]
\inputtikz{RotatingRingStableSolutions}
\caption{Equilibrum points of the rotating ring system with arrows describing whether it's a stable (attracting) or unstable state. The solution $θ_0$ becomes unstable with $\sfrac{ω^2}{ω_0^2} > 1$.}
\label{fig:Introduction:RotatingRingStable}
\end{figure}

Equilibrum states are those that arise as constant functions. Solving \eqref{eq:Introduction:RotatingRingEquation} for $θ = c$ constant, we get first $θ_0 = 0$ and \[ θ_s = \pm \arccos\left(\frac{ω_0^2}{ω^2}\right)\] as solutions, where the latter is only defined for $ω^2 ≥ ω_0^2$. This leads to a bifurcation, as can be seen on \fref{fig:Introduction:RotatingRingStable}.

In order to see that these states are actually stable and not static but unstable points is to see what happens with small perturbations. Thus, we would study the case with initial flow $θ(0) = θ_s \pm εθ'$, and then see what does the solution tend to. I would do it but I don't want to deal with nasty trigonometric calculations, that's for engineers.

After those nasty computations, we would end up with a simplified equation for $θ'$ given by \[ \ddot{θ}' = -θ'ω^2 \sin^2 θ_s \] whose solution is a pure imaginary exponential. That is, we have an stable value.

\chapter{Instabilities}

\section{Rayleigh-Taylor instability}

\begin{figure}[hbtp]
\begin{minipage}[b]{0.45\textwidth}
\centering
\includegraphics[width=0.8\textwidth]{img/RayleighTaylorInstability.png}
\captionof{figure}{Image of the evolution of the interface with Rayleigh-Taylor instability.}
\label{fig:RayleighTaylorInterfaceImage}
\end{minipage}
\hfill
\begin{minipage}[b]{0.45\textwidth}
\inputtikz{RayleighTaylorModel}
\captionof{figure}{Simplified model of two liquids: 2D and with infinite semiplanes.}
\label{fig:RayleighTaylorModel}
\end{minipage}
\end{figure}

Our first instability will be Rayleigh-Taylor, which models a situation with two impermeable liquids, one below of the other.

To simplify the study of these kind of instabilities, we simplify down to a situation like in \fref{fig:RayleighTaylorModel}. We assume a potential flow with no rotation and no vorticity. Then, to study it we will follow the steps outlined previously.

\subsection{Base state}

Our potential flow is $ΔΦ_1 = ΔΦ_2 = 0$, so our velocity equations are \begin{align*}
U_1 &= \dpd{Φ_1}{x} & V_1 = \dpd{Φ_1}{z} \\
U_2 &= \dpd{Φ_2}{x} & V_2 = \dpd{Φ_2}{z}
\end{align*}

The velocities $U$ represent the movement of the flow parallel to the $x$ axis, and $V$ represents the velocity parallel to the $z$ axis.

The boundary conditions will be zero values for $Φ_1$ and $Φ_2$ at $z = \pm ∞$ respectively: we don't want the flows to move at infinity.

\begin{figure}
\centering
\inputtikz{RayleighTaylorInterface}
\caption{Interface η in Rayleigh-Taylor instability.}
\label{fig:RayleighTaylorInterface}
\end{figure}

The next step is the definition of the interface, the set of points where the two flows ``touch'', and define the relations at that boundary. The first condition is that of impermeability: no particles pass through the interface. That means that whatever displacement $δη_\perp$ of the interface in its normal direction must be caused by the velocity of the flow. On one hand, our displacement is $δη_\perp = ∂η_t \cos α$. On the other, we have two sources of velocity of the flow: the vertical movement $V_1$ and the horizontal $U_1$. For both of them we will calculate their projection normal to the interface at any point. Thus, we will have
\begin{align}
δη_\perp &= V_\perp - U_\perp \nonumber \\
\dpd{η}{t} \cos α &= V_1 \cos α - U_1 \sin α \nonumber \\
\dpd{η}{t} &= V_1 - U_1 \tan α \nonumber \\
\dpd{η}{t} &= V_1 - U_1 \dpd{η}{x} \label{eq:RayleighTaylor:KinematicConds}
\end{align}

We will have analogous equations for the second fluid.

Now we have to define the dynamic boundary conditions, the ones that relate the interface to the difference of pressure between the two fluids.

Our kinematic condition is that we will force impermeability, so that normal components to the interface must be equal. Now for the fluid we write down some equations and something.

Now on to the dynamic boundary conditions. Using Laplace's law for pressure % TODO: Write it
which tells us that $P_1 - P_2 = γ\frac{2}{R}$, with γ the surface tension and $R$ the radius of curvature. Thus, our condition at $z = η$ \( P_1 - P_2 = -γ \frac{\dpd[2]{η}{x}}{\left(1 + \left(\pd{η}{x}\right)^2 \right)^{\sfrac{3}{2}}} \label{eq:RayleighTaylor:DynamicConds} \)

Finally, we have the Bernouilli's principle to tie everything up:

\begin{align}
\dpd{Φ_1}{t} + \frac{U_1^2 + V_1^2}{2} + \frac{P_1}{ρ_1} + gz &= C_1(t) \label{eq:RayleighTaylor:Bernoulli} \\
\dpd{Φ_2}{t} + \frac{U_2^2 + V_2^2}{2} + \frac{P_2}{ρ_2} + gz &= C_2(t) \\
\end{align}

Looking at these relations at infinity, we assume that nothing changes there so we can equate $C_1(t) = C_2(t) = 0$ and life is easier. Putting everything together, our equations defining the base state of the system are the following:

\begin{align*}
0&= Φ_1(∞) & 0&= Φ_2(-∞) \\
U_1 &= \dpd{Φ_1}{x} & U_2 &= \dpd{Φ_2}{x} \\
V_1 &= \dpd{Φ_1}{z} & V_2 &= \dpd{Φ_2}{z} \\
\dpd{η}{t} &= V_1 - U_1 \dpd{η}{x} & \dpd{η}{t} &= V_2 - U_2 \dpd{η}{x} \\
0 &= \dpd{Φ_1}{t} + \frac{U_1^2 + V_1^2}{2} + \frac{P_1}{ρ_1} + gz &
	0 &= \dpd{Φ_2}{t} + \frac{U_2^2 + V_2^2}{2} + \frac{P_2}{ρ_2} + gz \\
\end{align*}
\vspace{-30pt}
\[ P_1 - P_2 = -γ \frac{\dpd[2]{η}{x}}{\left(1 + \left(\pd{η}{x}\right)^2 \right)^{\sfrac{3}{2}}} \]

\subsection{Small perturbation and linearization}

To study what happens, we add small perturbations $εφ_1$ and $εφ_2$ to the flows (maintaining $φ_1 = φ_2 = 0$ at $\pm ∞$ respectively), $εp_1$, $εp_2$ to the pressure and $εσ$ to the interface displacement, with $ε \ll 1$; and we study what happens. For the kinematic conditions \eqref{eq:RayleighTaylor:KinematicConds}, we will see that the perturbation follows the equation \[ ε \pd{σ}{t} = εv_1 - ε^2 u_1 \pd{σ}{x} \] with $v_1 = ∂_z φ_1$, $u_1 = ∂_x φ_1$. Given that ε is small, we can ignore the quadratric term so we have the following equations: \[ v_1 = v_2 = \pd{σ}{t} \text{ at } z = εσ  \]

We have a small problem there with the fact that we don't know where the interface is. However, as ε is small, we can do Taylor expansion\footnote{No we can't as we don't have absolutetly any regularity conditions assured. But this is not a mathematics course.} and set the interface at $z = 0$, with equations \( v_1 = v_2 = \pd{φ_1}{z} = \pd{φ_2}{z} = \pd{σ}{t} \text{ at } z = 0 \)

We do the same process with the dynamic conditions \eqref{eq:RayleighTaylor:DynamicConds}. The equations of the perturbation are \[ \eval{\left(P_1 + εp_1 -P_2 - εp_2\right)}_{εσ} = -γ ε \dpd[2]{σ}{x} \left(1 - \frac{3}{2}ε^2 \left(\dpd{σ}{x}\right)^2 \right)\] and replacing $P_1 = -gρ_1 z$ and linearizing and flattening (setting the interface at $z = 0$) we end up with \( (ρ_2 - ρ_1)gσ + \eval{(p_1 - p_2)}_{0} = - γ\dpd[2]{σ}{x} \)

Finally, doing the same with the Bernouilli relations \eqref{eq:RayleighTaylor:Bernoulli} (I'm not copying the computations again) we have \( \dpd{φ_1}{t} + \frac{p_1}{ρ_1} = 0 \qquad  \dpd{φ_2}{t} + \frac{p_2}{ρ_2} = 0 \)

\subsection{Normal mode analysis}

Given that the previous equations do not seem easy to solve analytically, we do some magic handwaving called normal mode analysis. With this, we assume that the solution is going to present periodical behaviour in $x$ and $t$, with an excitation depending on $z$. Assume the frequencies of these two excitations are $k$ and ω (notation: wavenumber and frequency), we would then have the following equations:\begin{align*}
φ_1 &= f_1(z)e^{\imath (kx - ωt)} \\
φ_2 &= f_2(z)e^{\imath (kx - ωt)} \\
σ &= C e^{\imath (kx - ωt)}
\end{align*}
\appendix

Now, because of some magical reason, we assume that $f_1(z) = Ae^{kz}$ and $f_2(z) = Be^{-kz}$ for some constants $A, B ∈ ℝ$. Replacing these solutions in the linearized equations, we end up with \begin{align*}
g(ρ_2 - ρ_1)C - \imath ωρ_1A - \imath ω ρ_2 B &= γk^2 C \\
kA &= -\imath ω C \\
kB &= -\imath ω C
\end{align*} which we can solve for $ω$ multiplying by $k$ and replacing $k A$ and $kB$:
\begin{align}
kg(ρ_2 - ρ_1)C + ω^2 ρ_1 C + ω^2 ρ_2 C &= γk^3 C \nonumber \\
ω^2 =\frac{-kg(ρ_2 - ρ_1) + γk^3 }{ρ_1 + ρ_2}
\end{align}

This is enough to do a quantitative analysis. If $\Im ω > 0$, in our flows $φ_1, φ_2$ we will have an exponential like $e^{\imath (- \imath \Im ω)} = e^{\Im ω}$, a positive exponential that will diverge, and thus we will have an unstable flow. The other possibility is that we have $\Im ω = 0$, in which case we would have oscillating solutions (imaginary exponential). The case $\Im ω < 0$ is not possible in this case, but if it were we would have a damped solution. These types of solutions appear when viscosity is not ignored.

\begin{figure}[hbtp]
\inputtikz{RayleighTaylorStability}
\caption{Imaginary value of the frequency $\Im ω$ in the Rayleigh-Taylor interface, depending on the the value $\frac{1}{λl_c}$, with $l_c$ the capillary length and $λ$ the wavelength. Red zones are unstable, green zones are stable. The dashed lines represent the case with damping, which is not possible with the simplficiations we have made.}
\label{fig:RayleighTaylor:Stability}
\end{figure}

What is interesting is that the stability depends on the fluid density. If $ρ_1 > ρ_2$ (that is, the denser fluid is below) then $ω^2$ is always positive and the solutions are oscillation. If $ρ_2 > ρ_1$ (denser fluid above), the unstable case may appear depending on the wavenumber, the pressure difference and the surface tension. We can, in fact, combine those three values in the capillary length, given by \[ l_c = \sqrt{\frac{γ}{g\abs{ρ_2 - ρ_1}}} \]

For clarity, we may consider what happens looking at the wavelength associated $λ = \frac{2π}{k}$.The possible wavelengths depend on the opening in which both fluids are connected. If the opening is smaller than the capillary length, we are in a stable situation (e.g., when we put a small tube filled with water facing down). If the opening is too big, we will be in an unstable case and the fluid will fall.

% \chapter{---}
% \input{tex/Instability_Exerc.tex}
\backmatter
\printindex
\end{document}
