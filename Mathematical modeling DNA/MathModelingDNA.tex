\documentclass[palatino]{epflnotes}

\title{Mathematical modeling of DNA}
\author{Guillermo Julián Moreno}
\date{16/17 - Spring semester}

% Additional packages
\usepackage{siunitx}

% --------------------

\begin{document}
\frontmatter
\pagestyle{plain}
\maketitle

\tableofcontents
\mainmatter
% Content

\chapter{Introduction and overview}

\section{Basics of \sectioncaps{DNA}}

\begin{wrapfigure}[12]{R}{0.4\textwidth}
\centering
\includegraphics[width = 0.4\textwidth]{img/DNA-structure-and-bases.png}
\caption{Molecular structure of DNA}
\label{fig:DNA}
\end{wrapfigure}

The bases of DNA are denoted by $\mathcal{L} = \set{A,T,C,G}$ with a complementary  rule, where \begin{align*}
\conj{A} &= T &\conj{C} &= G \\
\conj{T} &= A &\conj{G} &= C
\end{align*}

A somewhat interesting fact: the base of the DNA are antiparallel (orientation given by the orientation of the phosphate molecule).

The study of DNA can be separated in its three structures:
\begin{enumerate}
	\item The list of letters $x_i ∈ \mathcal{L} $ for $i = 1, \dotsc, 10^9$ (at least).
	\item The secondary structure is uniform: the double helix.
	\item The tertiary structure relates to the physical properties of the double helix, such as stiffness, which can vary greatly depending on the sequence (up to 25 \%), and its intrinsic shape (the shape of the central line).
\end{enumerate}

Molecular Dynamics simulations of the atoms in DNA and their surrounding medium (water) are considerably expensive, so the focus is in stochastic differential equations for which we can study output probability distribution.

The course-grained model implies simulating not all the atoms but only blocks (sugar, phosphate or whatever is a group for chemists), reducing thus the amount of degrees of freedom.

\section{Course-grained \sectioncaps{DNA} modeling}

We will be interested in models that predict the sequence ground-state structure and flexibility of a sequence. Each configuration space is a vector $\vw ∈ ℝ^N$ and the probability density function $ρ(\vw)$ depends on some constants $Z,β$ and the free energy $U(\vw)$, so that \[ ρ(\vw) = \frac{1}{Z} e^{-βU(\vw)} \]

As the conjugates for each base are clearly defined, we can worry just about the sequence of bases and not the full base pairs. The set of parameters being modeled will by $6n$ intra-basepair and $6(n-1)$ inter-basepair degrees of freedom (see \fref{fig:MovementsDNA}), so a total of $N = 12n - 6$ degrees of freedom for a sequence of $n$ basepairs.

For the cgDNA model, the free energy is approximated as a quadratic form \[ U(\vw)= \frac{1}{2} (\vw - μ) · \mK · (\vw -μ)\] with $μ = μ(S) ∈ ℝ^N$ being the ground state configuration and $\mK = \mK(S) ∈ ℝ^{N×N}$ being the ground-state stiffness, represented by a symmetric and positive-definite matrix.

Of course, the question is how to get those ground states $μ, \mK$ from the sequence $S$ you are studying. The main assumption is that those states are only affected by junction and intra-basepair interaction energies, as shown in \fref{fig:MovementsDNA}, and that the groudn state is the one with minimum energy. During these lectures we will introduce this model and do more things.

\begin{figure}[tbp]
\centering
\includegraphics[width=0.8\textwidth]{img/movementsDNA.png}
\caption{Interpair and intrapair interactions}
\label{fig:MovementsDNA}
\end{figure}

\chapter{cgDNA model}

We will consider the coarse-grain model of DNA in which each base on each strand is modeled as an independent rigid body. First, we will define what we mean by an independent rigid body and what mathematical tools do we need to deal with them, and then we will go straight to the modeling.

\section{Rigid body framings: $SE(3)$}

\section{Modeling of \sectioncaps{DNA} sequences}

\subsection{Framing of the base pairs}

\begin{figure}[hbtp]
\centering
\inputtikz{WatsonCrickModel}
\caption{Basic nomenclature in DNA sequences, with $X_i ∈ \set{T,A,C,G}.$}
\label{fig:WatsonCrickStrand}
\end{figure}

We consider a DNA molecule to be identified, as seen in \fref{fig:WatsonCrickStrand}, with a sequence of bases $\set{X_1, \dotsc, X_n}$ along one strand (one side of the helix for us non-biologists), listed in the $5'$ to $3'$ direction (that is, bottom to top). Each base pair is denoted by $(X, \conj{X})_i$, and we will ignore the atoms forming the sugar-phosphate backbones.


For each one of the base pairs we will consider two rigid body motions. One will be referring to the movement between one base and its corresponding one in the other strand, and the other one will model the rigid body motion from one strand to the next one.

\begin{figure}[hbtp]
\centering
\includegraphics[width=0.8\textwidth]{img/CrickWatson.png}
\caption{A schematic illustration of the base (red), base-pair (blue), and junction (green) frames for an isolated base-pair step.}
\end{figure}

% Missing some week 2 and week 3 material here

What we have then is that, for each level $i$ in the sequence, we have the positions and rotations $R_i^+ ≝ (\mR_i^+, \vr_i^+) ∈ SE(3)$ and $R_i^- ≝ (\mR_i^-, \vr_i^-) ∈ SE(3)$ of both bases (Watson and Crick strands respectively). We are interested in simplifying this and having a parametrization in which we can consider separately between the inter and intra basepair motions.

We will introduce then the position/rotation of the basepair as $R_i ≝ (\mR_i, \vr_i)$ defined as the ``average'' of $R_i^+$ and $R_i^-$. For the rotation that is half the rotation from $\mR_i^+$ to $\mR_i^-$, and for the position that is the midpoint between $\vr_i^+$ and $\vr_i^-$:
\begin{align*}
\mR_i &= \mR_i^- \sqrt{\mQ_i} \\
\vr_i &= \frac{\vr_i^+ + \vr_i^-}{2}
\end{align*} with $\mQ_i = \trans{(\mR_i^-)} \mR_i^+$ the rotation between bases.

In a similar way we can write the displacement between pairs based on the junction frame, defined as \begin{align*}
\mJ_i &= \mR_i \sqrt{\mP_i} \\
\vj_i &= \frac{\vr_i + \vr_{i+1}}{2}
\end{align*} with $\mP_i = \trans{\mR_i} \mR_{i+1}$ being the rotation between base-pair frames.

We can keep on simplifying further: we can get rid of global rotations and translation of the full DNA sequence if we consider not a series of frames and positions but a series of movements and rotations to get from one basepair to another instead.

This leads us to define a set of DNA coordinates starting from an initial assumed configuration $R_1 = (\mop{Id}, \vec{0})$, the intra-pair rigid body motions $Q_i ≝ (\mQ_i, \vq_i)$ and the inter-pair ones $P_i ≝ (\mP_i, \vp_i)$. These allow the calculation of each base position and frame by a recursion relation:
\begin{align*}
\begin{pmatrix} \mR_{i+1} & \vr_{i+1} \\ 0 & 1 \end{pmatrix} &=
	\begin{pmatrix} \mR_i & \vr_i \\ 0 & 1 \end{pmatrix}
	\begin{pmatrix} \mP_i & \sqrt{\mP_i} \vp_i \\ 0 & 1 \end{pmatrix} \\
\begin{pmatrix} \mR_i^+ & \vr_i^+ \\ 0 & 1 \end{pmatrix} &=
	\begin{pmatrix} \mR_i^{-} & \vr_i^- \\ 0 & 1 \end{pmatrix}
	\begin{pmatrix} \mQ_i & \sqrt{\mQ_i} \vq_i \\ 0 & 1 \end{pmatrix}
\end{align*}

The displacements $\vp_i$ and $\vq_i$ can be simply calculated from that relation of recurrence as \begin{align*}
\vp_i &= \trans{\sqrt{\mP_i}} \trans{\mR_i} (\vr_{i+1} - \vr_{i}) = \trans{\mJ} \underbracket{(\vr_{i+1} - \vr_{i})}_{Δ\vr_i} \\
\vq_i &= \sqrt{\trans{\mQ_i}} \trans{(\mR_i^-)} (\vr_i^+ - \vr_i^-) = \mR_i \underbracket{(\vr_i^+ - \vr_i^-)}_{δ\vr_i}
\end{align*}

That is, $\vp_i$ and $\vq_i$ are, respectively, the inter-pair and intra-pair displacements $Δ\vr_i$ and $δ\vr_i$ in the corresponding frames $\mJ_i$ and $\mR_i$. This definition will also be helpful if at some point in the future we want to ``reverse'' the sequences, as we are setting reference frames that will not depend on the direction we traverse the sequence in.

We can improve this a little bit more. Both $\mQ_i$ and $\mP_i$ are in $SO(3)$, that is, we have 9 entries each but there are only 3 independent parameters for each rotation (the ones described in \fref{fig:MovementsDNA}).

So, we need to get to a minimal set of coordinates by introducing the Cayley transform. Provided that neither $\mP_i$ or $\mQ_i$ are close to rotations by π, there exists an unique mapping \begin{align*}
\appl{\cayley}{SO(3) & }{ℝ^3} \\
\mP_i &\longmapsto \vu_i \\
\mQ_i &\longmapsto \veta_i
\end{align*}

The question is, however, in which frame are the components of $\vu_i$. The available optionsare $\mR_i, \mJ_i$ or $\mR_{i+1}$. Similarly, we need to know in which frame are the components of $\veta_i$, as we can have $\mR_i^-$ or $\mR_i$ or $\mR_i^+$.

A nice property of Cayley vector is that it has the same coordinates for all the frames along the rotation, so the answer is that the components of $\vu_i$ are the same in $\mR_i, \mJ_i$ and $\mR_{i+1}$ as it represents the rotation from $\mR_i$ to $\mR_{i+1}$ with $\mJ_i$ being the rotation at the midpoint. The same applies to $\veta_i$.

Finally, we can explain the cgDNA model configuration coordinates. This has, for a $N$ base pair ligomer, a vector $\vw ∈ ℝ^{12N - 6}$ given by $\vw = (\vy_1, \vz_1, \dotsc, \vz_{N-1}, \vy_N)$ where $\vz_i ∈ ℝ^6$ are the inter pair rotations and translations and $\vy_i ∈ ℝ^6$ are the intra pair rotations and translations with the rotations as a Cayley vector. We will sometimes be also interested in vectors $\vx_i = \left(\vy_i, \vz_i, \vy_{i+1}\right) ∈ ℝ^{18}$ for modeling the overlapping of the junctions.

\subsubsection{Inversion of sequences}

We briefly consider here the transformation rule for inversion of a sequence. We will prove later in detail, but if $\vw$ are the coordinates for a specific configuration of the DNA fragment for one choice of the Watson strand then the coordinates $\bar{\vw}$ for the configuration in the reverse sense are $\bar{\vw} = \mE_{2N - 1} \vw$ where \[ \mE_{2N-1} = \begin{pmatrix} 0 & \cdots & \mE \\ \vdots &\iddots & \vdots \\ \mE & \cdots & 0 \end{pmatrix} \] with $\mE ∈ ℝ^{6×6}$ just $-1, +1, +1, -1, +1, +1$ on the leading diagonal.

\subsection{Energy of the DNA sequence configuration}

The cgDNA model predicts a probability density function $ρ(\vw; S, P)$ for each configuration $\vw$, depending on the sequence $S$ and the parameter set $P$. For convenience, $S$ and $P$ may be suppressed anywhere in notation.

The assumption is that the PDF is going to be related to an energy distribution, with lower energy states being more probable. Thus, the formula will be something like \[ ρ(\vw; S, P) = \frac{1}{Z} e^{- U(\vw; S, P)} \] where $Z$ is the normalizing constant and $U$ will be quadratic polynomial in $\vw$.

In order to derive the expression for the energy, we assume that the energy of a DNA configuration depends on the energy between bases in a pair and on the cross-junction interaction energies. We assume that all those interactions are quadratic and have minimum-energy states $\hat{\vy}_i$ and $\hat{\vx}_j$ so the energy takes on a form like this: \( \label{eq:ExplicitEnergy} 2U(\vw) = \sum_{i = 1}^N (\vy_i - \hat{\vy}_i) · \mK_{i}^\text{BP} · (\vy_i - \hat{\vy}_i) + \sum_{j=1}^{N-1} (\vx_j - \hat{\vx}_j) \mK^\text{J}_j (\vx_j - \hat{\vx}_j)\) which represent respectively the sum of something over basepairs and sum over junctions, and where where $\vx_j = (\vy_j, \vz_i, \vy_{i+1})$ as defined previously. Also $\mK_i^\text{BP} ∈ ℝ^{6×6}$ and $\mK_{j}^\text{J} ∈ ℝ^{18 × 18}$ are symmetric.

It can be shown that this expression is simplifiable to a single quadratic form if we get rid of constant terms. This expression is
\( \label{eq:SingleQuadraticEnergy} U(\vw) = \frac{1}{2} (\vw - \vmu(S)) · \mK(S) · (\vw - \vmu(S)) \) where $\mK(S) ∈ ℝ^{(12N - 6) × (12N - 6)}$ is a symmetric and positive-definite matrix. Also, $\vmu(S) ∈ ℝ^{12N-6}$ will be the ground-state vector.

An interesting thing about this expression is that, while we have built a model based on local interactions, the ``competition'' between ground states $\hat{\vy}_i$ and $\hat{\vx}_i$ for each of the different energies will imply non-local sequence dependence\footnote{One can show it doing some computations and linear algebra. But it's not interesting.}.

Both the energy matrix $\mK$ and the ground state will have a dependence on both the sequence $S$ and the parameter set $\mathcal{P}$. For now we will not define the parameter set as it is \textit{a lot} of work\footnote{Probably weeks 8-13 of the course.} and we will just assume it given as it changes only rarely.

\subsubsection{Sequence dependence}

We need to detail from there are the matrices and ground states coming from. Given a sequence of bases $S = \set{x_1, x_2, \dotsc, x_N}$, we will first select the stiffness matrix $i$ as $\mK_i^\text{BP} = \mK^{x_i}$, where $\mK^A, \mK^T, \mK^C, \mK^G ∈ \mathcal{P}$ are given matrices in the parameter set.

That is, we make the assumption that $\mK_i^\text{BP}$ depends only on the composition of the basepair $i$ (that is, the bases) and not on the order of that basepair in the sequence. Similarly assume that $\hat{\vy}_i = \hat{\vy}_{x_i}$ depends only on the bases and not on the position.

The matrices for the junctions are obtained with an analogous assumption: they only depend on the composition of the bases of the junction, so that $\mK_j^\text{J} = \mK^{x_j, x_j+1}$ with $\mK^\text{AA}, \mK^\text{AT}, \dotsc, \mK^{\text{CC}}, \mK^\text{CG} ∈ \mathcal{P}$. We will force these matrices to be symmetric and as we did previously, force $\hat{\vx}_i$ to depend only on the bases and not on their positions.

It is important to see that, for now, we have introduced only local dependence of parameters on the sequence.

Another interesting question is to see why have we chosen quadratic forms for energy. The answer is that it seems to fit with experimental data. It is, however, a big approximation.

We will assess the validity of these assumptions later in the course. For example, there are complications in the first and last junctions and base-pairs, and this is a current research topic.

\subsubsection{Connection between explicit equation and single quadratic form and conditions on stiffness matrices}

We are going to explore a little bit more the connection between the explicit equation of energy \eqref{eq:ExplicitEnergy} and the single quadratic form \eqref{eq:SingleQuadraticEnergy}. By doing a bit of linear algebra, we can show that \[ (\vx - \va) \mA (\vx - \va) + (\vx - \vb) \mB (\vx - \vb) = (\vx - \vc) \mC (\vx - \vc) + \text{constant} \] where $\mC = \mA + \mB$ and $\vc = \inv{\mC}(\mA \va + \mB \vb)$. We can use this to express the sums of \eqref{eq:ExplicitEnergy} in a single quadratic form, getting rid of the constant which is not relevant for energy-minimization purposes.

\begin{figure}[hbtp]
\centering
\includegraphics[width=\textwidth]{img/StiffnessBuilding.png}
\caption{Gray matrices represent basepair matrices, white represent junction matrices and the numbers define the index of the corresponding basepairs.}
\label{fig:StiffnessBuilding}
\end{figure}

In our case, for the summation of two matrices of different dimension we will have to ``pad'' with zeros and build the corresponding matrix, as can be seen in \fref{fig:StiffnessBuilding}.

Based on this formulation, we can infer some properties of the resulting stiffness matrix $\mK$ that are valid for any sequence. First, as all junction and basepair matrices are symmetric, $\mK$ is symmetric too.

A second property is that $\mK$ is banded. Particularly, the sparsity pattern is overlapping $18 × 18$ blocks. This is \textit{a big assumption} that will play a big part in estimating parameter sets. Physically, this means that the interactions modeled are only corresponding to the nearest neighbors of each base.

Finally, we want to see when is $\mK$ positive definite. Recall that a symmetric matrix is positive-definite if and only if $\trans{\vx}\mA \vx > 0$ for all $\vx ≠ 0$. Assume all the junction and basepair matrices $\mK^α, \mK^{α,β}$ are positive definite ($α,β ∈ \set{C,G,A,T}$). Then, $\mK$ must be positive definite because of its definition as $\trans{\vx} \mK \vx = \sum \vy \mK^α \vy + \sum \vz \mK^{α,β} \vz$.

However, this condition is too strong and can lead to indefinite matrices with eigenvalues too close to zero. A weaker sufficient condition is just to have \begin{align*}
\mK^α + \mK^{α,β} + \frac{1}{2} \mK^β &> 0 \\
\frac{1}{2} \mK^α + \mK^{α,β} +  \frac{1}{2} \mK^β &> 0
\end{align*} which allows us to have negative eigenvalues on $\mK^α$ for some values.

In order to prove this, one has to ``expand'' the stiffness matrix so that no overlaps occur, in a way that all the blocks are of the two forms presented above. One can prove that, if $\vx = (x_1, x_2, \dotsc, x_N)$ and $\mC$ is the ``expanded'' matrix form of $\mK$, then $\trans{\vx} \mK \vx = \trans{\vz} \mC \vz$ with $\vz = (x_1, x_2, x_3, x_3, x_4, x_5, x_5, \dotsc)$. So, if $\mC$ is positive definite, $\mK$ is positive definite too.

An interesting issue arising from this is that basepair matrices having negative eigenvalues imply that some pairs do not have minimum ground-states and then may blow apart. Turns out that it is actually something that happens in reality: short DNA polymers ($N < 5$) disintegrate.

\subsubsection{Conditions on shifts $\vec{μ}(S)$ and non-local dependence}

As we explained previously, we assumed that the ground state vectors $\hat{\vy}_i = \hat{\vy}^α$ and $\hat{\vx}_i = \hat{\vy}^{α,β}$ are given in the parameter set and depend only on the bases $α,β ∈ \set{C,G,A,T}$.

Thus, the calculation of $\vec{μ}$ simply implies solving the linear system: \[ \mK \vec{μ} = \sum_{i=1}^N \mK_i^\text{BP} \hat{\vy}_i + \sum_{j=1}^{N-1} \mK_j^\text{J} \hat{\vx}_i \]

A remark is that naked values of $\hat{\vy}^α$ and $\hat{\vx}^{α,β}$ never appear so the parameter set only stores the values of $\vec{σ}^α = \mK^α \hat{\vy}^α$ and $\vec{σ}^{α,β} = \mK^{α,β} \hat{\vx}^{α,β}$. This also works pretty well with the calculations of matrix overlapping, as we can define \[ \vec{σ}(S) = \sum \vec{σ}_i^\text{BP} + \sum \vec{σ}_j^\text{J}\] and \[ \mK \vec{μ} = \vec{σ} \iff \vec{μ} = \inv{\mK} \vec{σ} \] which gives non-local sequence dependence of $\vec{μ}$, as the inverse matrix $\inv{\mK}$ is dense.

\subsubsection{Some extra remarks on the cgDNA model}

Recall that the energy is \( ρ(\vw; S, P) = \frac{1}{Z} e^{ - \frac{1}{2} (\vw - \vmu(S)) · \mK(S) · (\vw - \vmu(S))} \label{eq:EnergyPDF} \) which we can regard as a Gaussian PDF. Despite the fact that we have vectors in specific spaces (specially the Cayley vectors) we will use the usual Lebesgue measure in $ℝ^{12N - 6}$ when we perform integrals, as that will allow us to use the regular formulas for Gaussian functions in multiple dimensions.

We also recall from the last exercise session\footnote{TODO: Actually do these exercises. Week 5 session.} that the PDF of a sequence $S$ defines exactly the PDF of the complementary $\conj{S}$, with \begin{align*}
\conj{\vec{μ}} &= \mE_n \vec{μ} \\
\conj{\mK} &= \mE_n · \mK · \mE_n
\end{align*}

In the specific case of palindromic sequences, we have as expected $\conj{S} = S$ which implies constraints on the cgDNA ground state, namely $\vmu = \mE_n \vmu$ and similarly for $\mK$. These will be considerably important later for parameter estimation.

Yet another unrelated remark is that we need a discussion of the units of entries in $\vmu$ and $\mK$, and we will discuss those later again.

\chapter{cgDNA experiments}

Once we know the model, we can start performing experiments with it. We have as discussed previously a Gaussian probability density function, and we will use it to calculate certain expectations and probabilities. In particular, we will look at two experiments: the first will look at the probability of configurations with two fixed ends, and the second something spaghetti.

These experiments require a minimum of one hundred basepairs, and are thus way beyond the capabilities of molecular dynamics simulations.

For experiments with fewer basepairs such as NMR (Nuclear Magnetic Resonance) and X-Ray crystal structures, the reports are that the shapes are a function of sequences, so those results are used for estimation of parameters for the cgDNA model.

For NMR and X-Ray crystal experiments, the rigid base movements can be observed and the full vector $\vw ∈ ℝ^{12N - 6}$ can be computed. For the two experiments that we will look at below (looping and persistence length), the length of the strand implies that it is impossible to get those intra base-pair parameters and thus we will only see the shapes parametrized by the inter base-pair rigid body motions.

Therefore, we will compute expectations and probabilities on the base pair frames $(\mR_i, \vr_i)$ and we won't need the intra basepair frames (although they will play an important role in the computation later on). Also, those frames $(\mR_i, \vr_i)$ are a complicated, nonlinear function of the inter variables in junctions $1, 2, \dotsc, i - 1$, and even when we have a Gaussian we will not be able to easily compute expectations and probabilities of $(\mR_i, \vr_i)$.

The main advantage, however, is that it is very easy and efficient to sample random numbers with a normal distribution so Monte Carlo techniques will be very well suited for our purposes. Using the cgDNAmc software, based on a sequence and parameters $\set{S, \mathcal{P}}$ we will get a set $\set{\vw^j}_{j = 1}^M$ of $M$ possible positions\footnote{For us, $M \sim 10^6$. With HPC techniques you can get to $10^{14}$.} and then we can approximate moments $\pesc{φ(\vw)}$ as \[ \pesc{φ(\vw)} = \frac{1}{Z} \idotsint\limits_{ℝ^{12N - 6}} φ(\vw) ρ(\vw) \dif \vw \approx \frac{1}{M} \sum_{j=1}^M φ(\vw^j) \]

\section{Persistence length experiments}

As discussed above, for persistence length experiments we will be interested in computing the expectations of two specific functions, pretty common in polymer physics. First,
\(φ_n(\vw) = \mR_1^T (\vr_n - \vr_1) ∈ ℝ^3, \; n = 2, \dotsc, N \label{eq:FloryVector} \)
which is the end to end chord vector in components of the first base pair frame. This is sometimes called the \concept{Flory\IS vector}. It is important to fix the coordinates to avoid having a zero average because of symmetry.

The second choice of function to study is \( \label{eq:RotationMatrixPerslength} γ_n(\vw) = \mR_1^T \mR_n ∈ SO(3),\; n = 2, \dotsc, N \) which is the relative rotation of the orientation between the first and the $n$th basepairs.

The point is that given a configuration $\vw$ in the internal cgDNA coordinates, we can compute both $φ_n$ and $γ_n$ as a function of $\vw$ with a horrible but explicit function.

To define correctly all those transformations, we define $\mX_n = (\mR_n, \vr_n) ∈ SO(3)$ as the usual matrix representation. We also have the recursion \[ \mX_n = \mX_{n-1} \left(\mQ_{n-1}, \vq_{n-1}\right) \] where $(\mQ_{n-1}$, $\vq_{n-1})$ is the $n-1$ junction rigid body motion. We also know that $\mQ_{n-1} = \mop{Cayley}(\vu_{n-1})$ so that we can reconstruct everything.

What we will do is to plot $\log γ_n$ and $φ_n$ with respect to $n$ and what we will observe is that $\log γ_n$ is close to linear but with different slopes for each sequence, and that $φ_n$ tends to a single point for different sequences.

We don't actually know how to prove that behavior with the cgDNA model. However, we will be able to do it for simpler rigid base-pairs with nearest-neighbor rigid base interactions and an uniform chain.

A simple proof is the following. We have the recursion $\mX_n = \mX_{n-1} \mA_{n-1}$ with $\mA_{n-1} ≝ (\mQ_{n-1}, \vq_{n-1}) ∈ SE(3)$, so that $\mX_n = \mX_1 \mA_1 \dotsb \mA_{n-1}$ so that \[ \inv{\mX_{1}} \mX_n = \prod_{k = 1}^{n - 1} \mA_k\]

We also know that $\inv{\mX_1} = (\trans{\mR_1}, - \trans{\mR_1}\vr_1)$ and then \[ \prod_{k = 1}^{n - 1} \mA_k = ( \trans{\mR_1} \mR_n, \trans{\mR_1}(\vr_n - \vr_1))\] which are , by no accident, the choices we made for $φ_n$ and $γ_n$. This implies that the expectation \[ \pesc{\mX_1^{-1} \mX_n} = \pesc{\prod_{k=1}^{n-1} \mA_k} = \prod_{k=1}^{n-1} \pesc{\mA_k} = \left(\pesc{\mQ_k}, \pesc{\vq_k}\right)  \]
assuming nearest-neighbor rigid base pair functions (not true for cgDNA). Thus, if the chain is uniform\footnote{?¿?¿?¿} we have $(\pesc{\mQ}, \pesc{\vq}) ≝ (\mY, \vy)$ with $\norm{\mY} < 1$ and then \[ \pesc{\inv{\mX_1} \mX_n} = (\mY, \vy)^{n-1}= (\mY^{n-1}, (I + \mY + \mY^2 + \dotsb + \mY^{n-1})\vy))\]  which is why it goes down exponentially, with $\mY^{n-1} \to 0$. Additionally, we have that $(I + \mY + \mY^2 + \dotsb + \mY^{n-1})\vy) \to (I - Y)^{-1} \vy$.

Despite having made assumptions that are not valid for the cgDNA model, these results will be valid for those simulations.

\section{Looping or cyclization experiments}


\appendix

\chapter{Exercises}
\input{tex/MathModelingDNA_Exerc.tex}
\backmatter
\printindex
\end{document}
